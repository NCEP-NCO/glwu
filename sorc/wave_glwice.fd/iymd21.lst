Page 1           Source Listing                  IYMD21
2017-04-04 20:16                                 iymd21.f

      1 C/ ------------------------------------------------------------------- /
      2       INTEGER FUNCTION IYMD21 ( NYMD ,M )
      3 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
      4 C                .      .    .                                       .
      5 C SUBPROGRAM:    IYMD21      INCREMENT DATE BY +- 1
      6 C   PRGMMR: H.S. CHEN        ORG: W/NP21     DATE: 1998-10-29
      7 C
      8 C ABSTRACT: INCREMENT DATE BY +/- 1
      9 C
     10 C PROGRAM HISTORY LOG:
     11 C   98-10-18  H.L. TOLMAN ORIGINATION
     12 C   98-10-29  H.S. CHEN   ADDING DOCBLOCK
     13 C             H.L. TOLMAN
     14 C
     15 C USAGE: SEE ORIGINAL DOCUMENTATION BELOW.
     16 C
     17 C REMARKS: SEE ORIGINAL DOCUMENTATION BELOW.
     18 C
     19 C ATTRIBUTES:
     20 C   LANGUAGE: FORTRAN 77-90
     21 C   MACHINE:  CRAY C90 / IBM RS6000 SP
     22 C
     23 C$$$
     24 C/                  +-----------------------------------+
     25 C/                  | WAVEWATCH-III           NOAA/NCEP |
     26 C/                  |           H. L. Tolman            |
     27 C/                  |                        FORTRAN 77 |
     28 C/                  | Last update :         18-Oct-1998 |
     29 C/                  +-----------------------------------+
     30 C/                                Based on INCYMD of the GLA GCM.
     31 C/
     32 C  1. Purpose :
     33 C
     34 C     Increment date in YYYYMMDD format by +/- 1 day.
     35 C
     36 C  3. Parameters :
     37 C
     38 C     Parameter list
     39 C     ----------------------------------------------------------------
     40 C       NYMD    Int.   I   Old date in YYMMDD format.
     41 C       M       Int.   I   +/- 1 (Day adjustment)
     42 C     ----------------------------------------------------------------
     43 C
     44 C  4. Subroutines used :
     45 C
     46 C       STRACE
     47 C
     48 C  5. Called by :
     49 C
     50 C     Any subroutine.
     51 C
     52 C  8. Structure :
     53 C
     54 C     See source code.
     55 C
     56 C  9. Switches :
     57 C

Page 2           Source Listing                  IYMD21
2017-04-04 20:16                                 iymd21.f

     58 C     C/S  Enable subroutine tracing using STRACE.
     59 C
     60 C 10. Source code :
     61 C
     62 C/
     63 C/ ------------------------------------------------------------------- /
     64 C/ Parameter list
     65 C/
     66       INTEGER         NYMD, M
     67 C/
     68 C/ ------------------------------------------------------------------- /
     69 C/ Local parameters
     70 C/
     71       INTEGER         NDPM(12), NY, NM, ND
     72       LOGICAL         LEAP
     73 C/
     74 C/ ------------------------------------------------------------------- /
     75 C/
     76       DATA     NDPM / 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 /
     77 *
     78 * "Unpack" and increment date :
     79 *
     80       NY   = NYMD / 10000
     81       NM   = MOD(NYMD,10000) / 100
     82       NM   = MIN ( 12 , MAX(1,NM) )
     83       ND   = MOD(NYMD,100) + M
     84       LEAP = MOD(NY,400).EQ.0 .OR.
     85      &        ( MOD(NY,4).EQ.0 .AND. MOD(NY,100).NE.0 )
     86 *
     87 * M = -1, change month if necessary :
     88 *
     89       IF (ND.EQ.0) THEN
     90           NM   = NM - 1
     91           IF (NM.EQ.0) THEN
     92               NM   = 12
     93               NY   = NY - 1
     94             ENDIF
     95           ND   = NDPM(NM)
     96           IF (NM.EQ.2 .AND. LEAP)  ND = 29
     97         ENDIF
     98 *
     99 * M = 1, leap year
    100 *
    101       IF (ND.EQ.29 .AND. NM.EQ.2 .AND. LEAP)  GO TO 20
    102 *
    103 *        next month
    104 *
    105       IF (ND.GT.NDPM(NM)) THEN
    106           ND = 1
    107           NM = NM + 1
    108           IF (NM.GT.12) THEN
    109               NM = 1
    110               NY = NY + 1
    111           ENDIF
    112         ENDIF
    113 *
    114    20 CONTINUE

Page 3           Source Listing                  IYMD21
2017-04-04 20:16                                 iymd21.f

    115       IYMD21 = NY*10000 + NM*100 + ND
    116 *
    117       RETURN
    118 C/
    119 C/ End of IYMD21 ----------------------------------------------------- /
    120 C/
    121       END


ENTRY POINTS

  Name               
                     
 iymd21_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 20                         Label  114                                                            101                               
 IYMD21                     Func   2        I(4)            4           scalar                    115                               
 IYMD21@0                   Local  2        I(4)            4           scalar                                                      
 LEAP                       Local  72       L(4)            4           scalar                    84,96,101                         
 M                          Dummy  2        I(4)            4           scalar   ARG,INOUT        83                                
 MAX                        Func   82                                   scalar                    82                                
 MIN                        Func   82                                   scalar                    82                                
 MOD                        Func   81                                   scalar                    81,83,84,85                       
 ND                         Local  71       I(4)            4           scalar                    83,89,95,96,101,105,106,115       
 NDPM                       Local  71       I(4)            4     1     12                        76,95,105                         
 NM                         Local  71       I(4)            4           scalar                    81,82,90,91,92,95,96,101,105,107,1
                                                                                                  08,109,115                        
 NY                         Local  71       I(4)            4           scalar                    80,84,85,93,110,115               
 NYMD                       Dummy  2        I(4)            4           scalar   ARG,INOUT        80,81,83                          

Page 4           Source Listing                  IYMD21
2017-04-04 20:16 Subprograms/Common Blocks       iymd21.f



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IYMD21                     Func   2        I(4)            4           scalar                    115                               

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume byterecl                      -assume nocc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume old_ldout_format              -assume noold_logical_ldio
       -assume old_maxminloc                 -assume old_xor
       -assume protect_constants             -assume noprotect_parens
       -assume split_common                  -assume source_include
       -assume nostd_intent_in               -assume std_minus0_rounding
       -assume nostd_mod_proc_name           -assume std_value
       -assume norealloc_lhs                 -assume underscore
       -assume no2underscores                -auto
  no   -auto_scalar                     no   -bintext
       -ccdefault default                    -check noargs
       -check noarg_temp_created             -check noassume
       -check nobounds                       -check noformat
       -check nooutput_conversion            -check nooverflow
       -check nopointers                     -check power
       -check noshape                        -check nostack
       -check nounderflow                    -check nouninitialized
       -coarray-num-procs 0             no   -coarray-config-file
       -convert big_endian                   -cross_reference
       -D __INTEL_COMPILER=1500              -D __INTEL_COMPILER_UPDATE=3
       -D __unix__                           -D __unix
       -D __linux__                          -D __linux
       -D __gnu_linux__                      -D unix
       -D linux                              -D __ELF__
       -D __x86_64                           -D __x86_64__
       -D __amd64                            -D __amd64__
       -D _MT                                -D __INTEL_COMPILER_BUILD_DATE=20150407
       -D __INTEL_OFFLOAD                    -D __pentium4
       -D __pentium4__                       -D __tune_pentium4__
       -D __SSE2__                           -D __SSE2_MATH__

Page 5           Source Listing                  IYMD21
2017-04-04 20:16                                 iymd21.f

       -D __SSE3__                           -D __SSSE3__
       -D __SSE4_1__                         -D __SSE4_2__
       -D __SSE__                            -D __SSE_MATH__
       -D __MMX__                            -D __AVX__
       -D __AVX_I__                          -D __AVX2__
       -D __CRAYXC                           -D __CRAY_HASWELL
       -D __CRAYXT_COMPUTE_LINUX_TARGET       -double_size 64
  no   -d_lines                         no   -Qdyncom
       -error_limit 30                  no   -f66
  no   -f77rtl                          no   -fast
       -fpscomp nofilesfromcmd               -fpscomp nogeneral
       -fpscomp noioformat                   -fpscomp noldio_spacing
       -fpscomp nologicals                   -fixed
  no   -fpconstant                           -fpe3
       -fprm nearest                    no   -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -heap_arrays 0
  no   -threadprivate_compat                 -g0
       -iface nomixed_str_len_arg            -iface nono_mixed_str_len_arg
       -init noarrays                        -init noinf
       -init nonan                           -init nosnan
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
  no   -module                               -names lowercase
  no   -noinclude                            -offload-build=host
       -O2                              no   -pad_source
       -real_size 32                    no   -recursive
       -reentrancy none                 no   -sharable_localsaves
       -vec=simd                             -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w alignments                         -w noargument_checking
       -w nodeclarations                     -w general
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w notruncated_source
       -w uncalled                           -w uninitialized
       -w nounused                           -w usage
  no   -wrap-margins

       -includepath : /opt/cray/rca/1.0.0-2.0502.57212.2.56.ari/include/,/opt/cray/ugni/6.0-1.0502.10245.9.9.ari/include/,
           /opt/intel/composer_xe_2015.3.187/ipp/include/,/usr/local/include/,.f90,./.f90,/opt/cray/iobuf/2.0.5/include/.f90,
           /opt/cray/mpt/7.2.0/gni/mpich2-intel/140/include/.f90,/opt/cray/libsci/13.0.3/INTEL/140/x86_64/include/.f90,
           /opt/cray/rca/1.0.0-2.0502.57212.2.56.ari/include/.f90,/opt/cray/alps/5.2.3-2.0502.9295.14.14.ari/include/.f90,
           /opt/cray/xpmem/0.1-2.0502.57015.1.15.ari/include/.f90,/opt/cray/gni-headers/4.0-1.0502.10317.9.2.ari/include/.f90,
           /opt/cray/pmi/5.0.6-1.0000.10439.140.2.ari/include/.f90,/opt/cray/ugni/6.0-1.0502.10245.9.9.ari/include/.f90,
           /opt/cray/udreg/2.3.2-1.0502.9889.2.20.ari/include/.f90,/opt/cray/wlm_detect/1.0-1.0502.57063.1.1.ari/include/.f90,
           /opt/cray/krca/1.0.0-2.0502.57202.2.45.ari/include/.f90,/opt/cray-hss-devel/7.2.0/include/.f90,/opt/intel/composer_xe_2015.3.187/ipp/include/.f90,
           /opt/intel/composer_xe_2015.3.187/mkl/include/.f90,/opt/intel/composer_xe_2015.3.187/tbb/include/.f90,
           /opt/intel/composer_xe_2015.3.187/compiler/include/intel64/.f90,/opt/intel/composer_xe_2015.3.187/compiler/include/.f90,
           /usr/local/include/.f90,/usr/lib64/gcc/x86_64-suse-linux/4.3/include/.f90,/usr/lib64/gcc/x86_64-suse-linux/4.3/include-fixed/.f90,
           /usr/include/.f90,/usr/include/.f90,/usr/include/.f90
       -list filename : iymd21.lst

Page 6           Source Listing                  IYMD21
2017-04-04 20:16                                 iymd21.f

       -o    filename : none

COMPILER: Intel(R) Fortran 15.0-1812
