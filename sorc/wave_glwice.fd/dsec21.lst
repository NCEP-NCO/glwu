Page 1           Source Listing                  DSEC21
2017-04-04 20:16                                 dsec21.f

      1 C/ ------------------------------------------------------------------- /
      2       REAL FUNCTION DSEC21 ( TIME1, TIME2 )
      3 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
      4 C                .      .    .                                       .
      5 C SUBPROGRAM:    DSEC21      TIME DIFFERENCE IN SECONDS
      6 C   PRGMMR: HENDRIK          ORG: W/NP21     DATE: 2000-12-28
      7 C
      8 C ABSTRACT: CALCULATE TIME DIFFERENCE IN SECONDS BETWEEN TWO DATES
      9 C   IN YYYYMMDD HHMMSS FORMAT.
     10 C
     11 C PROGRAM HISTORY LOG:
     12 C   93-03-29  H.L. TOLMAN ORIGINATION
     13 C   98-10-29  H.S. CHEN   ADDING DOCBLOCK
     14 C             H.L. TOLMAN
     15 C   00-12-28  H.L. TOLMAN LEAP YEAR EOY FIX
     16 C
     17 C USAGE: SEE ORIGINAL DOCUMENTATION BELOW.
     18 C
     19 C REMARKS: SEE ORIGINAL DOCUMENTATION BELOW.
     20 C
     21 C ATTRIBUTES:
     22 C   LANGUAGE: FORTRAN 77-90
     23 C   MACHINE:  CRAY C90-J90 / IBM RS6000 SP
     24 C
     25 C$$$
     26 C/                  +-----------------------------------+
     27 C/                  | WAVEWATCH-III           NOAA/NCEP |
     28 C/                  |           H. L. Tolman            |
     29 C/                  |                        FORTRAN 77 |
     30 C/                  | Last update :         29-Mar-1993 |
     31 C/                  +-----------------------------------+
     32 C/
     33 C  1. Purpose :
     34 C
     35 C     Calculate the time difference in seconds between two times in
     36 C     YYMMD HHMMMSS formats.
     37 C
     38 C  3. Parameters :
     39 C
     40 C     Parameter list
     41 C     ----------------------------------------------------------------
     42 C       TIMEn   I.A.   I   Times, TIMEn(1) is date in YYYYMMDD format,
     43 C                          TIMEn(2) is time in HHMMSS format.
     44 C     ----------------------------------------------------------------
     45 C
     46 C  4. Subroutines used :
     47 C
     48 C       MYMD21   Calculate Julian data.
     49 C
     50 C  5. Called by :
     51 C
     52 C     Any routine.
     53 C
     54 C  7. Remarks :
     55 C
     56 C  8. Structure :
     57 C

Page 2           Source Listing                  DSEC21
2017-04-04 20:16                                 dsec21.f

     58 C     See source code.
     59 C
     60 C  9. Switches :
     61 C
     62 C     C/S  Enable subroutine tracing using STRACE.
     63 C
     64 C 10. Source code :
     65 C/
     66 C/ ------------------------------------------------------------------- /
     67 C/ Parameter list
     68 C/
     69       INTEGER         TIME1(2), TIME2(2)
     70 C/
     71 C/ ------------------------------------------------------------------- /
     72 C/ Local parameters
     73 C/
     74       INTEGER         NY1, ND1, NY2, ND2, NS1, NS2, NS, ND, NST
     75       INTEGER         MYMD21
     76       EXTERNAL        MYMD21
     77 C/
     78 C/ ------------------------------------------------------------------- /
     79 C/
     80 *
     81 * Convert dates and times :
     82 *
     83       NY1    = TIME1(1) / 10000
     84       ND1    = MYMD21 ( TIME1(1) )
     85       NS1    = TIME1(2)/10000*3600 + MOD(TIME1(2),10000)/100*60 +
     86      &         MOD(TIME1(2),100)
     87 *
     88       NY2    = TIME2(1) / 10000
     89       ND2    = MYMD21 ( TIME2(1) )
     90       NS2    = TIME2(2)/10000*3600 + MOD(TIME2(2),10000)/100*60 +
     91      &         MOD(TIME2(2),100)
     92 *
     93 * Number of days and seconds in difference :
     94 *
     95       ND     = ND2 - ND1
     96 *
     97       IF (NY1.NE.NY2) THEN
     98           NST    = SIGN ( 1 , NY2-NY1 )
     99   100     CONTINUE
    100           IF (NY1.EQ.NY2) GOTO 200
    101           IF (NST.GT.0) THEN
    102               NY2    = NY2 - 1
    103               ND     = ND  + MYMD21 ( NY2*10000 + 1231 )
    104             ELSE
    105               ND     = ND  - MYMD21 ( NY2*10000 + 1231 )
    106               NY2    = NY2 + 1
    107             ENDIF
    108           GOTO 100
    109   200     CONTINUE
    110         ENDIF
    111 *
    112       NS     = NS2 - NS1
    113 *
    114 * Output of time difference :

Page 3           Source Listing                  DSEC21
2017-04-04 20:16                                 dsec21.f

    115 *
    116       DSEC21 = REAL(NS) + 86400.*REAL(ND)
    117 *
    118       RETURN
    119 C/
    120 C/ End of DSEC21 ----------------------------------------------------- /
    121 C/
    122       END


ENTRY POINTS

  Name               
                     
 dsec21_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 100                        Label  99                                                             108                               
 200                        Label  109                                                            100                               
 DSEC21                     Func   2        R(4)            4           scalar                    116                               
 DSEC21@0                   Local  2        R(4)            4           scalar                                                      
 MOD                        Func   85                                   scalar                    85,86,90,91                       
 MYMD21                     Func   75       I(4)            4           scalar                    84,89,103,105                     
 ND                         Local  74       I(4)            4           scalar                    95,103,105,116                    
 ND1                        Local  74       I(4)            4           scalar                    84,95                             
 ND2                        Local  74       I(4)            4           scalar                    89,95                             
 NS                         Local  74       I(4)            4           scalar                    112,116                           
 NS1                        Local  74       I(4)            4           scalar                    85,112                            
 NS2                        Local  74       I(4)            4           scalar                    90,112                            
 NST                        Local  74       I(4)            4           scalar                    98,101                            
 NY1                        Local  74       I(4)            4           scalar                    83,97,98,100                      
 NY2                        Local  74       I(4)            4           scalar                    88,97,98,100,102,103,105,106      
 REAL                       Func   116                                  scalar                    116                               
 SIGN                       Func   98                                   scalar                    98                                
 TIME1                      Dummy  2        I(4)            4     1     2        ARG,INOUT        83,84,85,86                       
 TIME2                      Dummy  2        I(4)            4     1     2        ARG,INOUT        88,89,90,91                       

Page 4           Source Listing                  DSEC21
2017-04-04 20:16 Subprograms/Common Blocks       dsec21.f



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DSEC21                     Func   2        R(4)            4           scalar                    116                               

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume byterecl                      -assume nocc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume old_ldout_format              -assume noold_logical_ldio
       -assume old_maxminloc                 -assume old_xor
       -assume protect_constants             -assume noprotect_parens
       -assume split_common                  -assume source_include
       -assume nostd_intent_in               -assume std_minus0_rounding
       -assume nostd_mod_proc_name           -assume std_value
       -assume norealloc_lhs                 -assume underscore
       -assume no2underscores                -auto
  no   -auto_scalar                     no   -bintext
       -ccdefault default                    -check noargs
       -check noarg_temp_created             -check noassume
       -check nobounds                       -check noformat
       -check nooutput_conversion            -check nooverflow
       -check nopointers                     -check power
       -check noshape                        -check nostack
       -check nounderflow                    -check nouninitialized
       -coarray-num-procs 0             no   -coarray-config-file
       -convert big_endian                   -cross_reference
       -D __INTEL_COMPILER=1500              -D __INTEL_COMPILER_UPDATE=3
       -D __unix__                           -D __unix
       -D __linux__                          -D __linux
       -D __gnu_linux__                      -D unix
       -D linux                              -D __ELF__
       -D __x86_64                           -D __x86_64__
       -D __amd64                            -D __amd64__
       -D _MT                                -D __INTEL_COMPILER_BUILD_DATE=20150407
       -D __INTEL_OFFLOAD                    -D __pentium4
       -D __pentium4__                       -D __tune_pentium4__
       -D __SSE2__                           -D __SSE2_MATH__

Page 5           Source Listing                  DSEC21
2017-04-04 20:16                                 dsec21.f

       -D __SSE3__                           -D __SSSE3__
       -D __SSE4_1__                         -D __SSE4_2__
       -D __SSE__                            -D __SSE_MATH__
       -D __MMX__                            -D __AVX__
       -D __AVX_I__                          -D __AVX2__
       -D __CRAYXC                           -D __CRAY_HASWELL
       -D __CRAYXT_COMPUTE_LINUX_TARGET       -double_size 64
  no   -d_lines                         no   -Qdyncom
       -error_limit 30                  no   -f66
  no   -f77rtl                          no   -fast
       -fpscomp nofilesfromcmd               -fpscomp nogeneral
       -fpscomp noioformat                   -fpscomp noldio_spacing
       -fpscomp nologicals                   -fixed
  no   -fpconstant                           -fpe3
       -fprm nearest                    no   -ftz
       -fp_model noprecise                   -fp_model fast
       -fp_model nostrict                    -fp_model nosource
       -fp_model nodouble                    -fp_model noextended
       -fp_model novery_fast                 -fp_model noexcept
       -fp_model nono_except                 -heap_arrays 0
  no   -threadprivate_compat                 -g0
       -iface nomixed_str_len_arg            -iface nono_mixed_str_len_arg
       -init noarrays                        -init noinf
       -init nonan                           -init nosnan
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
  no   -module                               -names lowercase
  no   -noinclude                            -offload-build=host
       -O2                              no   -pad_source
       -real_size 32                    no   -recursive
       -reentrancy none                 no   -sharable_localsaves
       -vec=simd                             -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w alignments                         -w noargument_checking
       -w nodeclarations                     -w general
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w notruncated_source
       -w uncalled                           -w uninitialized
       -w nounused                           -w usage
  no   -wrap-margins

       -includepath : /opt/cray/rca/1.0.0-2.0502.57212.2.56.ari/include/,/opt/cray/ugni/6.0-1.0502.10245.9.9.ari/include/,
           /opt/intel/composer_xe_2015.3.187/ipp/include/,/usr/local/include/,.f90,./.f90,/opt/cray/iobuf/2.0.5/include/.f90,
           /opt/cray/mpt/7.2.0/gni/mpich2-intel/140/include/.f90,/opt/cray/libsci/13.0.3/INTEL/140/x86_64/include/.f90,
           /opt/cray/rca/1.0.0-2.0502.57212.2.56.ari/include/.f90,/opt/cray/alps/5.2.3-2.0502.9295.14.14.ari/include/.f90,
           /opt/cray/xpmem/0.1-2.0502.57015.1.15.ari/include/.f90,/opt/cray/gni-headers/4.0-1.0502.10317.9.2.ari/include/.f90,
           /opt/cray/pmi/5.0.6-1.0000.10439.140.2.ari/include/.f90,/opt/cray/ugni/6.0-1.0502.10245.9.9.ari/include/.f90,
           /opt/cray/udreg/2.3.2-1.0502.9889.2.20.ari/include/.f90,/opt/cray/wlm_detect/1.0-1.0502.57063.1.1.ari/include/.f90,
           /opt/cray/krca/1.0.0-2.0502.57202.2.45.ari/include/.f90,/opt/cray-hss-devel/7.2.0/include/.f90,/opt/intel/composer_xe_2015.3.187/ipp/include/.f90,
           /opt/intel/composer_xe_2015.3.187/mkl/include/.f90,/opt/intel/composer_xe_2015.3.187/tbb/include/.f90,
           /opt/intel/composer_xe_2015.3.187/compiler/include/intel64/.f90,/opt/intel/composer_xe_2015.3.187/compiler/include/.f90,
           /usr/local/include/.f90,/usr/lib64/gcc/x86_64-suse-linux/4.3/include/.f90,/usr/lib64/gcc/x86_64-suse-linux/4.3/include-fixed/.f90,
           /usr/include/.f90,/usr/include/.f90,/usr/include/.f90
       -list filename : dsec21.lst

Page 6           Source Listing                  DSEC21
2017-04-04 20:16                                 dsec21.f

       -o    filename : none

COMPILER: Intel(R) Fortran 15.0-1812
